const { Model } = require('sequelize');

module.exports = (sequelize, DataTypes) => {
  class Like extends Model {

    static associate(models) {
      models.User.belongsToMany(
        models.Post,
        {
          as: 'fk_userId',
          through: 'like',
          foreignKey: 'userId',
          otherKey: 'postId',
        }
      );
    
      models.Post.belongsToMany(
        models.User,
        {
          as: 'fk_postId',
          through: 'like',
          foreignKey: 'postId',
          otherKey: 'userId',
        }
      );
    
      Like.belongsTo(models.Post, { foreignKey: 'postId' });
      Like.belongsTo(models.User, { foreignKey: 'userId' });
      models.User.hasMany(Like, { foreignKey: 'userId' });
      models.Post.hasMany(Like, { foreignKey: 'postId' });
    }
  };
  Like.init({
    isLike: DataTypes.BOOLEAN
  }, {
    modelName: 'like',
    sequelize
  });

  Like.beforeSync(() =>
    console.log('before creaing the Like table')
  );
  Like.afterSync(() =>
    console.log('before creaing the Like table')
  );
  return Like;
};